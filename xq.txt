xquery version "1.0";
let $d := doc("new-data.xml") 
return 
<html><head/><body>
{
for $i in $d//intervenant
return 
  <div>
    <h1>{data($i/@id)} : {data($i/nom)}</h1>
    <h2>Enseignements</h2>
    {
      for $j in $d//unite
      where $j/ref-intervenant/@ref = $i/@id
      return <p>{data($j/nom)}</p>
    }
    <h2>Responsable de spÃ©cialitÃ©</h2>
    {
      for $j in $d//specialite
      where $j/responsables/ref-intervenant/@ref = $i/@id
      return <p>{data($j/nom)}</p>
    }
    <h2>Intervient dans les parcours</h2>
    {
      for $j in $d//parcours
      where $j/responsables/ref-intervenant/@ref = $i/@id
      return <p>{data($j/nom)}</p>
    }
  </div>
}
</body>
</html>
